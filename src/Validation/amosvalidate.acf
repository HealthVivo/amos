## Validate an assembly in AMOS bank format

BINDIR = /fs/sz-user-supported/Linux-x86_64/bin
NUCMER = /fs/sz-user-supported/Linux-x86_64/bin/nucmer

PREF   = $(strip .bnk PREFIX)
INPUTS = $(PREF).bnk


## Creating FastA
100: $(BINDIR)/bank2fasta -b $(PREF).bnk > $(PREF).fasta

## Performing read mapping
200: $(BINDIR)/dumpreads $(PREF).bnk > $(PREF).seq
210: $(NUCMER) --maxmatch --prefix=$(PREF) $(PREF).fasta $(PREF).seq

## Analyzing mate-pairs
300: $(BINDIR)/asmQC -b $(PREF).bnk -numsd 2 -recompute -update -scaff
310: $(BINDIR)/asmQC -b $(PREF).bnk -numsd 2 -recompute -update -scaff
320: $(BINDIR)/asmQC -b $(PREF).bnk -cestat -feat -numsd 3 -scaff

## Analyzing SNPs
400: $(BINDIR)/analyzeSNPs -b $(PREF).bnk -S -cumqv 40 -minsnps 2 -r -e -H > $(PREF).snps
410: $(BINDIR)/clusterSnps $(PREF).snps > $(PREF).snp.feat
420: $(BINDIR)/loadFeatures $(PREF).bnk $(PREF).snp.feat

## Analyzing read coverage
500: $(BINDIR)/analyze-read-depth $(PREF).bnk -c 1000 -x 3 > $(PREF).depth.feat
510: $(BINDIR)/loadFeatures $(PREF).bnk $(PREF).depth.feat

## Analyzing alignment breakpoints
600: $(BINDIR)/casm-breaks $(PREF).delta -b $(PREF).bnk -F $(PREF).break.fea
610: $(BINDIR)/bank-transact -b $(PREF).bnk -m $(PREF).break.fea
